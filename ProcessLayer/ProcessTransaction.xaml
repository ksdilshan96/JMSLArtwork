<Activity mc:Ignorable="sap sap2010" x:Class="ProcessTransaction" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:uam="clr-namespace:UiPath.Azure.Models;assembly=UiPath.Azure" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_wbParentPath" Type="InArgument(x:String)" />
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="io_TransactionItem" Type="InOutArgument(sd:DataRow)" />
    <x:Property Name="in_TransactionNumber" Type="InArgument(x:Int32)" />
    <x:Property Name="in_RetryNumber" Type="InArgument(x:Int32)" />
    <x:Property Name="in_AzureStorageConnectionDetails" Type="InArgument(sd:DataTable)" />
    <x:Property Name="in_BlobContainerNames" Type="InArgument(sd:DataTable)" />
    <x:Property sap2010:Annotation.AnnotationText="Pass variable in to higher Scope " Name="io_PreviousTemplateName" Type="InOutArgument(x:String)" />
    <x:Property Name="in_DatabaseConnection" Type="InArgument(ui:DatabaseConnection)" />
    <x:Property Name="io_TemplateFullFilePath" Type="InOutArgument(x:String)" />
    <x:Property Name="in_DelayShort" Type="InArgument(x:TimeSpan)" />
    <x:Property Name="in_TimeoutShort" Type="InArgument(x:Int32)" />
    <x:Property Name="in_DelayMedium" Type="InArgument(x:TimeSpan)" />
    <x:Property Name="in_JMSL_APIConfig" Type="InArgument(scg:Dictionary(x:String, x:String))" />
    <x:Property Name="in_TimeoutMedium" Type="InArgument(x:Int32)" />
    <x:Property Name="io_PhotopeaUIBrowserElement" Type="InOutArgument(ui:Browser)" />
    <x:Property Name="io_IsRetry" Type="OutArgument(x:String)" />
    <x:Property Name="io_ExceptionRetryData" Type="InOutArgument(s:String[])" />
    <x:Property Name="in_QA_ProdSwitch" Type="InArgument(x:String)" />
  </x:Members>
  <VisualBasic.Settings>
    <x:Null />
  </VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>2100,8520</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ProcessTransaction_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="64">
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>System</x:String>
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Azure.Models</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Database.Activities</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Core</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Text.RegularExpressions</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.Azure</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldCollapseAll">False</x:Boolean>
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <TryCatch sap2010:Annotation.AnnotationText="##Business Process Layer##&#xA;&#xA;all the creative generation pending items comes as row by row from data view   -Done&#xA;Artwork creation process start baed on template &#xA;First time template will be downloaded and then it will run in locally when process end it will remove the template &#xA;Move into next Template and do the same process &#xA;clear the environment &#xA;" DisplayName="wbProcess" sap:VirtualizedContainerService.HintSize="2110,8455" sap2010:WorkflowViewState.IdRef="TryCatch_4">
    <TryCatch.Variables>
      <Variable x:TypeArguments="x:String" Name="wbPath" />
      <Variable x:TypeArguments="x:String" Name="wbName" />
      <Variable x:TypeArguments="s:DateTime" Name="wbStartTime" />
      <Variable x:TypeArguments="scg:IEnumerable(x:String)" Default="[New List(Of String)]" Name="ImageFullPaths" />
      <Variable x:TypeArguments="x:String" Name="CreativeID" />
      <Variable x:TypeArguments="x:String" Name="JMSL_AuthenticationToken" />
    </TryCatch.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsPinned">False</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <TryCatch.Try>
      <Sequence DisplayName="Try processing wbProcess" sap:VirtualizedContainerService.HintSize="2072,5252" sap2010:WorkflowViewState.IdRef="Sequence_47">
        <Sequence.Variables>
          <Variable x:TypeArguments="s:DateTime" Name="ArtworkCreationStartTime" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="During block startup, information about the path are constructed. It will be passed to any child workblock.&#xA;You should also publish the input arguments that you want to make available in the log" DisplayName="wbStartup" sap:VirtualizedContainerService.HintSize="2030,1328" sap2010:WorkflowViewState.IdRef="Sequence_65">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap2010:Annotation.AnnotationText="Edit to assign a name of your choosing" DisplayName="Assign workblock its name" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="Assign_10">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[wbName]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">ProcessTransaction</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Create current workblock path. This will be passed to children wb, if any" DisplayName="Create workblock path" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="Assign_11">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[wbPath]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[if (string.IsNullOrEmpty(in_wbParentPath), wbName, in_wbParentPath+"|"+wbName)]</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Assign template start time. " DisplayName="Assign start time" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="Assign_12">
            <Assign.To>
              <OutArgument x:TypeArguments="s:DateTime">[wbStartTime]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="s:DateTime">[datetime.Now]</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <ui:AddLogFields sap2010:Annotation.AnnotationText="Default wb fields&#xA;wbName&#xA;wbParentName&#xA;wbKey&#xA;wbPath&#xA;wbLevel&#xA;wbStartTime&#xA;wbState" DisplayName="Publish default wb fields" sap:VirtualizedContainerService.HintSize="436,222" sap2010:WorkflowViewState.IdRef="AddLogFields_27">
            <ui:AddLogFields.Fields>
              <InArgument x:TypeArguments="x:String" x:Key="wbName">[wbName]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbKey">[Guid.NewGuid.ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbPath">[wbPath]</InArgument>
              <InArgument x:TypeArguments="x:Int32" x:Key="wbLevel">[wbPath.Count(Function(x) x="|")]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbState">Executing</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbStartTime">[wbStartTime.ToString("yyyyMMdd HH:mm:ss.fff")]</InArgument>
            </ui:AddLogFields.Fields>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:AddLogFields>
          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_31" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                <Literal x:TypeArguments="x:String" Value="" />
              </InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">[Guid.NewGuid.ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">
                <Literal x:TypeArguments="x:String" Value="" />
              </InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Executing</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[wbStartTime.ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_Message">[wbPath + " execution started."]</InArgument>
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="436,139" sap2010:WorkflowViewState.IdRef="CommentOut_7">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_94">
                <ui:AddLogFields sap2010:Annotation.AnnotationText="Publish input fields&#xA;wbRetriesLeft" DisplayName="Add log fields" sap:VirtualizedContainerService.HintSize="338,103" sap2010:WorkflowViewState.IdRef="AddLogFields_28">
                  <ui:AddLogFields.Fields>
                    <InArgument x:TypeArguments="x:Int32" x:Key="wbRetriesLeft">[cint(in_Config.Item("MaxRetryNumber"))-in_RetryNumber]</InArgument>
                  </ui:AddLogFields.Fields>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:AddLogFields>
              </Sequence>
            </ui:CommentOut.Body>
          </ui:CommentOut>
          <ui:LogMessage DisplayName="Log execution started message" sap:VirtualizedContainerService.HintSize="436,92" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[wbPath + &quot; execution started.&quot;]" />
        </Sequence>
        <Flowchart sap2010:Annotation.AnnotationText="#Write business code here#" DisplayName="Process" sap:VirtualizedContainerService.HintSize="2030,1687" sap2010:WorkflowViewState.IdRef="Flowchart_1">
          <Flowchart.Variables>
            <Variable x:TypeArguments="uam:BlobContainer" Name="BlobContainer" />
            <Variable x:TypeArguments="x:String" Name="containerName" />
            <Variable x:TypeArguments="x:String" Name="CurrentTemplateName" />
            <Variable x:TypeArguments="x:String" Name="BlobFileNameWithFolder" />
            <Variable x:TypeArguments="sd:DataTable" Name="ProductImagesPlusDetails" />
            <Variable x:TypeArguments="x:String" Name="BlobFileName" />
            <Variable x:TypeArguments="uam:Blob" Name="DetailsofTheUploadedBlob" />
            <Variable x:TypeArguments="x:String" Name="LocalImageFullFilePath" />
            <Variable x:TypeArguments="x:String" Name="CreativeStoredUrl" />
            <Variable x:TypeArguments="x:String" Name="ArtworkStoreFullPath" />
            <Variable x:TypeArguments="x:Int32" Default="0" Name="count" />
            <Variable x:TypeArguments="uam:BlobContainer" Name="TemplateBlobContainer" />
            <Variable x:TypeArguments="x:Int32" Default="1" Name="FBSubCreativeProductReferenceID" />
            <Variable x:TypeArguments="s:DateTime" Name="FBArtworkCreationStartTime" />
          </Flowchart.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
              <av:Point x:Key="ShapeLocation">50,42.5</av:Point>
              <av:Size x:Key="ShapeSize">60,75</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">110,80 123,80 123,70</av:PointCollection>
              <x:Double x:Key="Width">1996</x:Double>
              <x:Double x:Key="Height">1619</x:Double>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Flowchart.StartNode>
            <x:Reference>__ReferenceID32</x:Reference>
          </Flowchart.StartNode>
          <FlowStep x:Name="__ReferenceID4">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:Point x:Key="ShapeLocation">1215.6,28.8</av:Point>
                <av:Size x:Key="ShapeSize">230,72</av:Size>
                <av:PointCollection x:Key="ConnectorLocation">1330.6,99.8 1330.6,129.8 1329.8,129.8 1329.8,140</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <WriteLine DisplayName="current template " sap:VirtualizedContainerService.HintSize="230,72" sap2010:WorkflowViewState.IdRef="WriteLine_1" Text="[&quot;Template :  &quot;+ CurrentTemplateName]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </WriteLine>
            <FlowStep.Next>
              <FlowStep x:Name="__ReferenceID2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">1198.8,140</av:Point>
                    <av:Size x:Key="ShapeSize">262,70</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">1198.8,175 1168.8,175 1168.8,168.6 1080,168.6</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign DisplayName="get container name where templates stored" sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_13">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[containerName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[in_BlobContainerNames.Rows(2).Item("ContainerName").ToString]</InArgument>
                  </Assign.Value>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Assign>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID1">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">880,121.6</av:Point>
                        <av:Size x:Key="ShapeSize">200,94</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">880,168.6 850,168.6 850,1 1482.8,1 1482.8,241 942.8,241</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="get template Storage Container " DisplayName="Get Azure conainer - templates" sap:VirtualizedContainerService.HintSize="200,94" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="Azure Storage\Get Azure Storage Containers.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <OutArgument x:TypeArguments="uam:BlobContainer" x:Key="out_BlobContainer">[BlobContainer]</OutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_ContainerName">[containerName]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_TokenKey">[in_AzureStorageConnectionDetails.Rows(0).Item("TokenKey").ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_ResourceGroupName">[in_AzureStorageConnectionDetails.Rows(0).Item("ResourceGroupName").ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_StorageAccountName">[in_AzureStorageConnectionDetails.Rows(0).Item("StorageAccount").ToString]</InArgument>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:InvokeWorkflowFile>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID21">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">508.8,200</av:Point>
                            <av:Size x:Key="ShapeSize">434,82</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">508.8,241 478.79999999999995,241 478.79999999999995,180 434,180</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign DisplayName="hold Template Blob Container" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_27">
                          <Assign.To>
                            <OutArgument x:TypeArguments="uam:BlobContainer">[TemplateBlobContainer]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="uam:BlobContainer">[BlobContainer]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                        <FlowStep.Next>
                          <FlowStep x:Name="__ReferenceID5">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:Point x:Key="ShapeLocation">0,139</av:Point>
                                <av:Size x:Key="ShapeSize">434,82</av:Size>
                                <av:PointCollection x:Key="ConnectorLocation">217,221 217,251 300,251 300,293.6</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign DisplayName="Get- Template name with folder name" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_15">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[BlobFileNameWithFolder]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[Regex.Match(io_TransactionItem("TemplateURL").ToString,"(?&lt;=templates\/)(.*)").ToString]</InArgument>
                              </Assign.Value>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Assign>
                            <FlowStep.Next>
                              <FlowStep x:Name="__ReferenceID8">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">200,293.6</av:Point>
                                    <av:Size x:Key="ShapeSize">200,52</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">300,345.6 300,446.4</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Template Identification Log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Template Changed : &quot;+(Not CurrentTemplateName.Equals(io_PreviousTemplateName)).ToString]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:LogMessage>
                                <FlowStep.Next>
                                  <FlowDecision x:Name="__ReferenceID6" Condition="[Not CurrentTemplateName.Equals(io_PreviousTemplateName)]" DisplayName="Download  Template First Time " sap:VirtualizedContainerService.HintSize="160,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">220,446.4</av:Point>
                                        <av:Size x:Key="ShapeSize">160,87</av:Size>
                                        <av:PointCollection x:Key="TrueConnector">220,490 170,490 170,587.2</av:PointCollection>
                                        <av:PointCollection x:Key="FalseConnector">380,489.9 410,489.9 410,324 908.8,324</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <FlowDecision.True>
                                      <FlowStep x:Name="__ReferenceID24">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <av:Point x:Key="ShapeLocation">70,587.2</av:Point>
                                            <av:Size x:Key="ShapeSize">200,52</av:Size>
                                            <av:PointCollection x:Key="ConnectorLocation">170,639.2 170,669.2 255.8,669.2 255.8,680</av:PointCollection>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_37" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Info</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Message" xml:space="preserve">Info: Process | If Previous template not equals to current template | Download current template </InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <FlowStep.Next>
                                          <FlowStep x:Name="__ReferenceID7">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:Point x:Key="ShapeLocation">38.8,680</av:Point>
                                                <av:Size x:Key="ShapeSize">434,82</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">255.8,762 255.8,770</av:PointCollection>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign DisplayName="Flag - Previous transaction template name " sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_16">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[io_PreviousTemplateName]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentTemplateName]</InArgument>
                                              </Assign.Value>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </Assign>
                                            <FlowStep.Next>
                                              <FlowStep x:Name="__ReferenceID15">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <av:Point x:Key="ShapeLocation">38.8,770</av:Point>
                                                    <av:Size x:Key="ShapeSize">434,82</av:Size>
                                                    <av:PointCollection x:Key="ConnectorLocation">255.8,852 170,852 170,873.6</av:PointCollection>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_22">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[io_TemplateFullFilePath]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[Directory.GetCurrentDirectory +"\templates\" + BlobFileNameWithFolder.Replace("/","\")]</InArgument>
                                                  </Assign.Value>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </Assign>
                                                <FlowStep.Next>
                                                  <FlowStep x:Name="__ReferenceID3">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <av:Point x:Key="ShapeLocation">70,873.6</av:Point>
                                                        <av:Size x:Key="ShapeSize">200,109</av:Size>
                                                        <av:PointCollection x:Key="ConnectorLocation">170,982.6 103.19999999999999,982.6 103.19999999999999,1012</av:PointCollection>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Download Template into Local folder called &quot;templates&quot;" DisplayName="Download Template " sap:VirtualizedContainerService.HintSize="200,109" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="Azure Storage\Download BLOB.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[BlobContainer]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_BlobName">[BlobFileNameWithFolder]</InArgument>
                                                        <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[in_TimeoutShort]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_LocalSaveFileName">[BlobFileNameWithFolder]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_BlobLocalSaveFilePath">[Directory.GetCurrentDirectory +"/templates/"]</InArgument>
                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:InvokeWorkflowFile>
                                                    <FlowStep.Next>
                                                      <FlowStep x:Name="__ReferenceID9">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <av:Point x:Key="ShapeLocation">3.19999999999999,1012</av:Point>
                                                            <av:Size x:Key="ShapeSize">200,75</av:Size>
                                                            <av:PointCollection x:Key="ConnectorLocation">203.2,1049.5 502.8,1049.5 502.8,324.5 908.8,324.5</av:PointCollection>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:Comment sap:VirtualizedContainerService.HintSize="200,75" sap2010:WorkflowViewState.IdRef="Comment_1" Text="Template Validation place here ">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:Comment>
                                                        <FlowStep.Next>
                                                          <FlowStep x:Name="__ReferenceID0">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <av:Point x:Key="ShapeLocation">908.8,268</av:Point>
                                                                <av:Size x:Key="ShapeSize">434,113</av:Size>
                                                                <av:PointCollection x:Key="ConnectorLocation">1342.8,324.5 1280,324.5 1280,324.6</av:PointCollection>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap2010:Annotation.AnnotationText="Get - Container Name Where Product images stored" DisplayName="Get - Container Name Where Product images stored" sap:VirtualizedContainerService.HintSize="434,113" sap2010:WorkflowViewState.IdRef="Assign_17">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[containerName]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[in_BlobContainerNames.Rows(1).Item("ContainerName").ToString]</InArgument>
                                                              </Assign.Value>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </Assign>
                                                            <FlowStep.Next>
                                                              <FlowStep x:Name="__ReferenceID11">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <av:Point x:Key="ShapeLocation">1280,271.6</av:Point>
                                                                    <av:Size x:Key="ShapeSize">200,106</av:Size>
                                                                    <av:PointCollection x:Key="ConnectorLocation">1480,324.6 1580,324.6</av:PointCollection>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="get product Storage Container " DisplayName="Get Azure conainer - product" sap:VirtualizedContainerService.HintSize="200,106" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" UnSafe="False" WorkflowFileName="Azure Storage\Get Azure Storage Containers.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <OutArgument x:TypeArguments="uam:BlobContainer" x:Key="out_BlobContainer">[BlobContainer]</OutArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_ContainerName">[containerName]</InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_TokenKey">[in_AzureStorageConnectionDetails.Rows(0).Item("TokenKey").ToString]</InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_ResourceGroupName">[in_AzureStorageConnectionDetails.Rows(0).Item("ResourceGroupName").ToString]</InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_StorageAccountName">[in_AzureStorageConnectionDetails.Rows(0).Item("StorageAccount").ToString]</InArgument>
                                                                    <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:InvokeWorkflowFile>
                                                                <FlowStep.Next>
                                                                  <FlowStep x:Name="__ReferenceID12">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <av:Point x:Key="ShapeLocation">1580,271.6</av:Point>
                                                                        <av:Size x:Key="ShapeSize">200,106</av:Size>
                                                                        <av:PointCollection x:Key="ConnectorLocation">1680,377.6 1680,441.6</av:PointCollection>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get Product Image and details for Transation " DisplayName="Get Product Image and details for Transation " sap:VirtualizedContainerService.HintSize="200,106" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_5" UnSafe="False" WorkflowFileName="Database\Get Product Image and details for Transation.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="sd:DataRow" x:Key="in_TransactionItem">[io_TransactionItem]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_ProductIamgePlusDetails">[ProductImagesPlusDetails]</OutArgument>
                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_QA_ProdSwitch">[in_QA_ProdSwitch]</InArgument>
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:InvokeWorkflowFile>
                                                                    <FlowStep.Next>
                                                                      <FlowStep x:Name="__ReferenceID14">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <av:Point x:Key="ShapeLocation">1580,441.6</av:Point>
                                                                            <av:Size x:Key="ShapeSize">200,106</av:Size>
                                                                            <av:PointCollection x:Key="ConnectorLocation">1580,494.6 1470,494.6</av:PointCollection>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Folder path check and create folder if not exist" DisplayName="Check Folder Existence " sap:VirtualizedContainerService.HintSize="200,106" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" UnSafe="False" WorkflowFileName="Common\CheckFolderExistence.xaml">
                                                                          <ui:InvokeWorkflowFile.Arguments>
                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_FolderName">Products</InArgument>
                                                                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                          </ui:InvokeWorkflowFile.Arguments>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:InvokeWorkflowFile>
                                                                        <FlowStep.Next>
                                                                          <FlowStep x:Name="__ReferenceID13">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <av:Point x:Key="ShapeLocation">1270,417.6</av:Point>
                                                                                <av:Size x:Key="ShapeSize">200,154</av:Size>
                                                                                <av:PointCollection x:Key="ConnectorLocation">1270,494.6 1050.3,494.6 1050.3,566.4</av:PointCollection>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Iterate and Save Images into Local folder&#xA;&#xA;all image Paths will be saved in a String()" DataTable="[ProductImagesPlusDetails]" DisplayName="Iterate and Save Images into Local folder" sap:VirtualizedContainerService.HintSize="200,154" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                                                              <ui:ForEachRow.Body>
                                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="imageDetail" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="887,1178" sap2010:WorkflowViewState.IdRef="Sequence_73">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="845,61" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_33" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                        </InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">[Guid.NewGuid.ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Executing</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Starting: Saving images in local folder</InArgument>
                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                    </ui:InvokeWorkflowFile>
                                                                                    <ui:LogMessage DisplayName="Image Url" sap:VirtualizedContainerService.HintSize="845,101" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Info" Message="[&quot;Image Url : &quot;+imageDetail(&quot;ImageURL&quot;).ToString.ToLower]">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:LogMessage>
                                                                                    <If Condition="[imageDetail(&quot;ImageURL&quot;).ToString.ToLower.Contains(&quot;footer&quot;) Or  imageDetail(&quot;ImageURL&quot;).ToString.ToLower.Contains(&quot;header&quot;) Or imageDetail(&quot;ImageURL&quot;).ToString.ToLower.Contains(&quot;block&quot;)]" sap:VirtualizedContainerService.HintSize="845,597" sap2010:WorkflowViewState.IdRef="If_11">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="400,429" sap2010:WorkflowViewState.IdRef="Sequence_83">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="358,61" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_34" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                                              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Info</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_Message">Info: Saving images in local folder| If file is a Header, Footer or block image</InArgument>
                                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                                          </ui:InvokeWorkflowFile>
                                                                                          <Assign sap2010:Annotation.AnnotationText="Get Blob FIle Name with Extension" DisplayName="Get Blob FIle Name with Extension" sap:VirtualizedContainerService.HintSize="358,101" sap2010:WorkflowViewState.IdRef="Assign_28">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[BlobFileName]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[Regex.Match(imageDetail("ImageURL").ToString,"(?&lt;=templates\/)(.*)").ToString]</InArgument>
                                                                                            </Assign.Value>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Assign>
                                                                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Check Whether Image ulready exist " sap:VirtualizedContainerService.HintSize="358,97" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_18" UnSafe="False" WorkflowFileName="Common\Check Whether Image ulready exist.xaml">
                                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="inFilePathWithExtension">[Directory.GetCurrentDirectory +"/Products/" + BlobFileName]</InArgument>
                                                                                              <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[TemplateBlobContainer]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_BlobFileName">[BlobFileName]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_BlobLocalSaveFilePath">[Directory.GetCurrentDirectory +"/Products/"]</InArgument>
                                                                                              <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[2000]</InArgument>
                                                                                              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:InvokeWorkflowFile>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="400,429" sap2010:WorkflowViewState.IdRef="Sequence_84">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="358,61" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_35" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                                              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Info</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_Message">Info: Saving images in local folder| If file is not a Header, Footer or block image</InArgument>
                                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                                          </ui:InvokeWorkflowFile>
                                                                                          <Assign sap2010:Annotation.AnnotationText="Get Blob FIle Name with Extension" DisplayName="Get Blob FIle Name with Extension" sap:VirtualizedContainerService.HintSize="358,101" sap2010:WorkflowViewState.IdRef="Assign_18">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[BlobFileName]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[Regex.Match(imageDetail("ImageURL").ToString,"(?&lt;=product\/)(.*)").ToString]</InArgument>
                                                                                            </Assign.Value>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Assign>
                                                                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Check Whether Image ulready exist " sap:VirtualizedContainerService.HintSize="358,97" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_8" UnSafe="False" WorkflowFileName="Common\Check Whether Image ulready exist.xaml">
                                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="inFilePathWithExtension">[Directory.GetCurrentDirectory +"/Products/" + BlobFileName]</InArgument>
                                                                                              <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[BlobContainer]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_BlobFileName">[BlobFileName]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_BlobLocalSaveFilePath">[Directory.GetCurrentDirectory +"/Products/"]</InArgument>
                                                                                              <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[2000]</InArgument>
                                                                                              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:InvokeWorkflowFile>
                                                                                        </Sequence>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                    <ui:MultipleAssign DisplayName="Parse image full path and image names " sap:VirtualizedContainerService.HintSize="845,108" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                          <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,32" sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="scg:IEnumerable(x:String)">[ImageFullPaths]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="scg:IEnumerable(x:String)">[ImageFullPaths.Append(Directory.GetCurrentDirectory +"\Products\"+BlobFileName.Replace("/","\"))]</InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="845,61" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_36" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Success</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(now.Subtract(wbStartTime).TotalSeconds).ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                        </InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Ended</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Ended: Saving images in local folder</InArgument>
                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:InvokeWorkflowFile>
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ForEachRow.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEachRow>
                                                                            <FlowStep.Next>
                                                                              <FlowDecision x:Name="__ReferenceID19" Condition="[io_TransactionItem(&quot;CreativeID&quot;).ToString.Contains(&quot;FB&quot;)]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <av:Point x:Key="ShapeLocation">1010.8,566.4</av:Point>
                                                                                    <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                                                    <x:String x:Key="FalseLabel">VB/EDM</x:String>
                                                                                    <x:String x:Key="TrueLabel">FB</x:String>
                                                                                    <av:PointCollection x:Key="FalseConnector">1089.8,609.9 1360,609.9 1360,660</av:PointCollection>
                                                                                    <av:PointCollection x:Key="TrueConnector">1010.8,609.9 945.895,609.9 945.895,660</av:PointCollection>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <FlowDecision.True>
                                                                                  <FlowStep x:Name="__ReferenceID29">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <av:Point x:Key="ShapeLocation">728.895,660</av:Point>
                                                                                        <av:Size x:Key="ShapeSize">434,82</av:Size>
                                                                                        <av:PointCollection x:Key="ConnectorLocation">945.895,742 860,742 860,753.6</av:PointCollection>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_31">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="s:DateTime">[FBArtworkCreationStartTime]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                                                                                      </Assign.Value>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </Assign>
                                                                                    <FlowStep.Next>
                                                                                      <FlowStep x:Name="__ReferenceID25">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <av:Point x:Key="ShapeLocation">760,753.6</av:Point>
                                                                                            <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                            <av:PointCollection x:Key="ConnectorLocation">860,805.6 860,843.5</av:PointCollection>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_39" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                          <ui:InvokeWorkflowFile.Arguments>
                                                                                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                              <Literal x:TypeArguments="x:String" Value="" />
                                                                                            </InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                              <Literal x:TypeArguments="x:String" Value="" />
                                                                                            </InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Executing</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[FBArtworkCreationStartTime.ToString]</InArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_Message">Starting: Process | Creating Artwork for Facebook</InArgument>
                                                                                          </ui:InvokeWorkflowFile.Arguments>
                                                                                        </ui:InvokeWorkflowFile>
                                                                                        <FlowStep.Next>
                                                                                          <FlowStep x:Name="__ReferenceID20">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <av:Point x:Key="ShapeLocation">760,843.5</av:Point>
                                                                                                <av:Size x:Key="ShapeSize">200,154</av:Size>
                                                                                                <av:PointCollection x:Key="ConnectorLocation">860,997.5 860,1050.4</av:PointCollection>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="in FB there will be sub artworks  for a single creative id &#xA;sub artwork saved adding count number to the artwork id " DataTable="[ProductImagesPlusDetails]" DisplayName="Create Sub artworks " sap:VirtualizedContainerService.HintSize="200,154" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                                                                                              <ui:ForEachRow.Body>
                                                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                                  <ActivityAction.Argument>
                                                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="SubArtworks" />
                                                                                                  </ActivityAction.Argument>
                                                                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="402,1071" sap2010:WorkflowViewState.IdRef="Sequence_78">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="360,60" sap2010:WorkflowViewState.IdRef="Assign_29">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="s:DateTime">[ArtworkCreationStartTime]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="360,60" sap2010:WorkflowViewState.IdRef="Assign_32">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[FBSubCreativeProductReferenceID]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[Cint(SubArtworks("AssetReference").ToString)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="360,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_40" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                                        </InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                                        </InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID+"_"+FBSubCreativeProductReferenceID.ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Executing</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[ArtworkCreationStartTime.ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">["Starting: Process | Creating Artwork for Facebook | Asset Reference: "+SubArtworks("AssetReference").ToString]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Create Artwork " sap:VirtualizedContainerService.HintSize="360,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_15" UnSafe="False" WorkflowFileName="Photopea\Create Artwork.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_TemplateFullFilePath">[io_TemplateFullFilePath]</InArgument>
                                                                                                        <InArgument x:TypeArguments="scg:IEnumerable(x:String)" x:Key="in_ImageFullPaths">[ImageFullPaths]</InArgument>
                                                                                                        <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ProductImagePlusDetails">[ProductImagesPlusDetails]</InArgument>
                                                                                                        <InOutArgument x:TypeArguments="sd:DataRow" x:Key="io_TransactionItem">[io_TransactionItem]</InOutArgument>
                                                                                                        <InOutArgument x:TypeArguments="x:String" x:Key="out_LocalImageFullFilePath">[LocalImageFullFilePath]</InOutArgument>
                                                                                                        <InOutArgument x:TypeArguments="x:String" x:Key="out_ArtworkStoreFullPath">[ArtworkStoreFullPath]</InOutArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CurrentImage">[SubArtworks("AssetReference").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_Count">[count]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_FBSubCreativeCount">[FBSubCreativeProductReferenceID]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_TimeoutShort">[in_TimeoutShort]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:TimeSpan" x:Key="in_DelayShort">[in_DelayShort]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:TimeSpan" x:Key="in_DelayMedium">[in_DelayMedium]</InArgument>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InOutArgument x:TypeArguments="ui:Browser" x:Key="io_PhotopeaUIBrowserElement">[io_PhotopeaUIBrowserElement]</InOutArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_QA_ProdSwitch">[in_QA_ProdSwitch]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CurrentTemplateName">[CurrentTemplateName]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_TimeoutMedium">[in_TimeoutMedium]</InArgument>
                                                                                                        <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[in_Config]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get creatives container&#xA;" DisplayName="Get Azure Storage Containers " sap:VirtualizedContainerService.HintSize="360,129" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_16" UnSafe="False" WorkflowFileName="Azure Storage\Get Azure Storage Containers.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <OutArgument x:TypeArguments="uam:BlobContainer" x:Key="out_BlobContainer">[BlobContainer]</OutArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ContainerName">creatives</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_TokenKey">[in_AzureStorageConnectionDetails.Rows(0).Item("TokenKey").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ResourceGroupName">[in_AzureStorageConnectionDetails.Rows(0).Item("ResourceGroupName").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_StorageAccountName">[in_AzureStorageConnectionDetails.Rows(0).Item("StorageAccount").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Upload created jpg into Azure Blob Storage &#xA;path will be - creatives" DisplayName="Upload BLOB into Azure Storage " sap:VirtualizedContainerService.HintSize="360,129" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_17" UnSafe="False" WorkflowFileName="Azure Storage\Upload BLOB into Azure Storage.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[BlobContainer]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_BlobName">[Regex.Match(io_TransactionItem("CreativeStorePath").ToString,"(?&lt;=creatives\/)(.*)").ToString+io_TransactionItem("CreativeID").ToString+"/"+io_TransactionItem("CreativeID").ToString+"_"+FBSubCreativeProductReferenceID.ToString+".jpg"]</InArgument>
                                                                                                        <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[2000]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ContentType">image/jpg</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_LocalImageFullFilePath">[LocalImageFullFilePath]</InArgument>
                                                                                                        <OutArgument x:TypeArguments="uam:Blob" x:Key="out_DetailsofTheUploadedBlob">[DetailsofTheUploadedBlob]</OutArgument>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="360,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_42" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Success</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(now.Subtract(ArtworkCreationStartTime).TotalSeconds).ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                                        </InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID+"_"+FBSubCreativeProductReferenceID.ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Ended</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">["Ended: Process | Creating Artwork for Facebook | Asset Reference: "+SubArtworks("AssetReference").ToString]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <Assign DisplayName="Send count to find correct image path" sap:VirtualizedContainerService.HintSize="360,60" sap2010:WorkflowViewState.IdRef="Assign_26">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[count]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[count+1]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </Sequence>
                                                                                                </ActivityAction>
                                                                                              </ui:ForEachRow.Body>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:ForEachRow>
                                                                                            <FlowStep.Next>
                                                                                              <FlowStep x:Name="__ReferenceID30">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <av:Point x:Key="ShapeLocation">760,1050.4</av:Point>
                                                                                                    <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                                    <av:PointCollection x:Key="ConnectorLocation">870,816.4 870,849.6</av:PointCollection>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_44" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                                    <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Success</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(now.Subtract(FBArtworkCreationStartTime).TotalSeconds).ToString]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Ended</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[FBArtworkCreationStartTime.ToString]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_Message">Ended: Process | Creating Artwork for Facebook</InArgument>
                                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                                </ui:InvokeWorkflowFile>
                                                                                              </FlowStep>
                                                                                            </FlowStep.Next>
                                                                                          </FlowStep>
                                                                                        </FlowStep.Next>
                                                                                      </FlowStep>
                                                                                    </FlowStep.Next>
                                                                                  </FlowStep>
                                                                                </FlowDecision.True>
                                                                                <FlowDecision.False>
                                                                                  <FlowStep x:Name="__ReferenceID28">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <av:Point x:Key="ShapeLocation">1229,660</av:Point>
                                                                                        <av:Size x:Key="ShapeSize">262,70</av:Size>
                                                                                        <av:PointCollection x:Key="ConnectorLocation">1360,730 1360,752.945676385978 1080,752.945676385978 1080,730 1200,730 1200,759</av:PointCollection>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_30">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="s:DateTime">[ArtworkCreationStartTime]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                                                                                      </Assign.Value>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </Assign>
                                                                                    <FlowStep.Next>
                                                                                      <FlowStep x:Name="__ReferenceID31">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <av:Point x:Key="ShapeLocation">1100,759</av:Point>
                                                                                            <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                            <av:PointCollection x:Key="ConnectorLocation">1200,811 1200,841 1210,841 1210,863.6</av:PointCollection>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;VB/EDM&quot;]">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:LogMessage>
                                                                                        <FlowStep.Next>
                                                                                          <FlowStep x:Name="__ReferenceID26">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <av:Point x:Key="ShapeLocation">1110,863.6</av:Point>
                                                                                                <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                                <av:PointCollection x:Key="ConnectorLocation">1210,915.6 1210,953.6</av:PointCollection>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_41" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                                                <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">0</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Executing</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">Starting: Process | Creating Artwork for Viber or EDM</InArgument>
                                                                                              </ui:InvokeWorkflowFile.Arguments>
                                                                                            </ui:InvokeWorkflowFile>
                                                                                            <FlowStep.Next>
                                                                                              <FlowStep x:Name="__ReferenceID10">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <av:Point x:Key="ShapeLocation">1110,953.6</av:Point>
                                                                                                    <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                                    <av:PointCollection x:Key="ConnectorLocation">1210,1005.6 1210,1051.6</av:PointCollection>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Create Artwork " sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Photopea\Create Artwork.xaml">
                                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_TemplateFullFilePath">[io_TemplateFullFilePath]</InArgument>
                                                                                                    <InArgument x:TypeArguments="scg:IEnumerable(x:String)" x:Key="in_ImageFullPaths">[ImageFullPaths]</InArgument>
                                                                                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ProductImagePlusDetails">[ProductImagesPlusDetails]</InArgument>
                                                                                                    <InOutArgument x:TypeArguments="sd:DataRow" x:Key="io_TransactionItem">[io_TransactionItem]</InOutArgument>
                                                                                                    <InOutArgument x:TypeArguments="x:String" x:Key="out_LocalImageFullFilePath">[LocalImageFullFilePath]</InOutArgument>
                                                                                                    <InOutArgument x:TypeArguments="x:String" x:Key="out_ArtworkStoreFullPath">[ArtworkStoreFullPath]</InOutArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CurrentImage">'</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:Int32" x:Key="in_Count">0</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:Int32" x:Key="in_FBSubCreativeCount">0</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:Int32" x:Key="in_TimeoutShort">[in_TimeoutShort]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:TimeSpan" x:Key="in_DelayShort">[in_DelayShort]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:TimeSpan" x:Key="in_DelayMedium">[in_DelayMedium]</InArgument>
                                                                                                    <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                    <InOutArgument x:TypeArguments="ui:Browser" x:Key="io_PhotopeaUIBrowserElement">[io_PhotopeaUIBrowserElement]</InOutArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_QA_ProdSwitch">[in_QA_ProdSwitch]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CurrentTemplateName">[CurrentTemplateName]</InArgument>
                                                                                                    <InArgument x:TypeArguments="x:Int32" x:Key="in_TimeoutMedium">[in_TimeoutMedium]</InArgument>
                                                                                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[in_Config]</InArgument>
                                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:InvokeWorkflowFile>
                                                                                                <FlowStep.Next>
                                                                                                  <FlowStep x:Name="__ReferenceID17">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <av:Point x:Key="ShapeLocation">1110,1051.6</av:Point>
                                                                                                        <av:Size x:Key="ShapeSize">200,94</av:Size>
                                                                                                        <av:PointCollection x:Key="ConnectorLocation">1210,1145.6 1210,1193.6</av:PointCollection>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get creatives container&#xA;" DisplayName="Get Azure Storage Containers " sap:VirtualizedContainerService.HintSize="200,94" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_9" UnSafe="False" WorkflowFileName="Azure Storage\Get Azure Storage Containers.xaml">
                                                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                                                        <OutArgument x:TypeArguments="uam:BlobContainer" x:Key="out_BlobContainer">[BlobContainer]</OutArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ContainerName">creatives</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_TokenKey">[in_AzureStorageConnectionDetails.Rows(0).Item("TokenKey").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ResourceGroupName">[in_AzureStorageConnectionDetails.Rows(0).Item("ResourceGroupName").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_StorageAccountName">[in_AzureStorageConnectionDetails.Rows(0).Item("StorageAccount").ToString]</InArgument>
                                                                                                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:InvokeWorkflowFile>
                                                                                                    <FlowStep.Next>
                                                                                                      <FlowStep x:Name="__ReferenceID16">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <av:Point x:Key="ShapeLocation">1110,1193.6</av:Point>
                                                                                                            <av:Size x:Key="ShapeSize">200,109</av:Size>
                                                                                                            <av:PointCollection x:Key="ConnectorLocation">1210,1302.6 1210,1355.6</av:PointCollection>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Upload created jpg into Azure Blob Storage &#xA;path will be - creatives" DisplayName="Upload BLOB into Azure Storage " sap:VirtualizedContainerService.HintSize="200,109" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_10" UnSafe="False" WorkflowFileName="Azure Storage\Upload BLOB into Azure Storage.xaml">
                                                                                                          <ui:InvokeWorkflowFile.Arguments>
                                                                                                            <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[BlobContainer]</InArgument>
                                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_BlobName">[Regex.Match(io_TransactionItem("CreativeStorePath").ToString,"(?&lt;=creatives\/)(.*)").ToString+io_TransactionItem("CreativeID").ToString+".jpg"]</InArgument>
                                                                                                            <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[in_TimeoutShort]</InArgument>
                                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_ContentType">image/jpg</InArgument>
                                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_LocalImageFullFilePath">[LocalImageFullFilePath]</InArgument>
                                                                                                            <OutArgument x:TypeArguments="uam:Blob" x:Key="out_DetailsofTheUploadedBlob">[DetailsofTheUploadedBlob]</OutArgument>
                                                                                                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                          </ui:InvokeWorkflowFile.Arguments>
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                        </ui:InvokeWorkflowFile>
                                                                                                        <FlowStep.Next>
                                                                                                          <FlowStep x:Name="__ReferenceID22">
                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                <av:Point x:Key="ShapeLocation">1110,1355.6</av:Point>
                                                                                                                <av:Size x:Key="ShapeSize">200,81</av:Size>
                                                                                                                <av:PointCollection x:Key="ConnectorLocation">1210,1436.6 1210,1474.4</av:PointCollection>
                                                                                                              </scg:Dictionary>
                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                            <Sequence DisplayName="Upload blob into public Storage" sap:VirtualizedContainerService.HintSize="200,81" sap2010:WorkflowViewState.IdRef="Sequence_86">
                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                                </scg:Dictionary>
                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get Public  creatives container&#xA;" DisplayName="Get Azure Storage Containers " sap:VirtualizedContainerService.HintSize="360,129" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_22" UnSafe="False" WorkflowFileName="Azure Storage\Get Azure Storage Containers.xaml">
                                                                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                                                                  <OutArgument x:TypeArguments="uam:BlobContainer" x:Key="out_BlobContainer">[BlobContainer]</OutArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ContainerName">creatives</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_TokenKey">[in_AzureStorageConnectionDetails.Rows(1).Item("TokenKey").ToString]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ResourceGroupName">[in_AzureStorageConnectionDetails.Rows(1).Item("ResourceGroupName").ToString]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_StorageAccountName">[in_AzureStorageConnectionDetails.Rows(1).Item("StorageAccount").ToString]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_databaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                                </ui:InvokeWorkflowFile.Arguments>
                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                  </scg:Dictionary>
                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                              </ui:InvokeWorkflowFile>
                                                                                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Upload created jpg into Azure Blob Storage &#xA;path will be - creatives" DisplayName="Upload BLOB into Azure Storage " sap:VirtualizedContainerService.HintSize="360,129" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_24" UnSafe="False" WorkflowFileName="Azure Storage\Upload BLOB into Azure Storage.xaml">
                                                                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                                                                  <InArgument x:TypeArguments="uam:BlobContainer" x:Key="in_BlobContainer">[BlobContainer]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_BlobName">[Regex.Match(io_TransactionItem("CreativeStorePath").ToString,"(?&lt;=creatives\/)(.*)").ToString+io_TransactionItem("CreativeID").ToString+".jpg"]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Key="in_Timeout">[in_TimeoutShort]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ContentType">image/jpeg</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_LocalImageFullFilePath">[LocalImageFullFilePath]</InArgument>
                                                                                                                  <OutArgument x:TypeArguments="uam:Blob" x:Key="out_DetailsofTheUploadedBlob">[DetailsofTheUploadedBlob]</OutArgument>
                                                                                                                  <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                                </ui:InvokeWorkflowFile.Arguments>
                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                  </scg:Dictionary>
                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                              </ui:InvokeWorkflowFile>
                                                                                                            </Sequence>
                                                                                                            <FlowStep.Next>
                                                                                                              <FlowStep x:Name="__ReferenceID27">
                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                    <av:Point x:Key="ShapeLocation">1110,1474.4</av:Point>
                                                                                                                    <av:Size x:Key="ShapeSize">200,52</av:Size>
                                                                                                                    <av:PointCollection x:Key="ConnectorLocation">1220,713.6 1220,743.6</av:PointCollection>
                                                                                                                  </scg:Dictionary>
                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_43" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                                                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                                                    <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Success</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(Now.Subtract(ArtworkCreationStartTime).TotalSeconds).ToString]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                                    </InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Ended</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[now.ToString]</InArgument>
                                                                                                                    <InArgument x:TypeArguments="x:String" x:Key="in_Message">Ended: Process | Creating Artwork for Viber or EDM</InArgument>
                                                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                                                </ui:InvokeWorkflowFile>
                                                                                                              </FlowStep>
                                                                                                            </FlowStep.Next>
                                                                                                          </FlowStep>
                                                                                                        </FlowStep.Next>
                                                                                                      </FlowStep>
                                                                                                    </FlowStep.Next>
                                                                                                  </FlowStep>
                                                                                                </FlowStep.Next>
                                                                                              </FlowStep>
                                                                                            </FlowStep.Next>
                                                                                          </FlowStep>
                                                                                        </FlowStep.Next>
                                                                                      </FlowStep>
                                                                                    </FlowStep.Next>
                                                                                  </FlowStep>
                                                                                </FlowDecision.False>
                                                                              </FlowDecision>
                                                                            </FlowStep.Next>
                                                                          </FlowStep>
                                                                        </FlowStep.Next>
                                                                      </FlowStep>
                                                                    </FlowStep.Next>
                                                                  </FlowStep>
                                                                </FlowStep.Next>
                                                              </FlowStep>
                                                            </FlowStep.Next>
                                                          </FlowStep>
                                                        </FlowStep.Next>
                                                      </FlowStep>
                                                    </FlowStep.Next>
                                                  </FlowStep>
                                                </FlowStep.Next>
                                              </FlowStep>
                                            </FlowStep.Next>
                                          </FlowStep>
                                        </FlowStep.Next>
                                      </FlowStep>
                                    </FlowDecision.True>
                                    <FlowDecision.False>
                                      <x:Reference>__ReferenceID0</x:Reference>
                                    </FlowDecision.False>
                                  </FlowDecision>
                                </FlowStep.Next>
                              </FlowStep>
                            </FlowStep.Next>
                          </FlowStep>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
            </FlowStep.Next>
          </FlowStep>
          <x:Reference>__ReferenceID1</x:Reference>
          <x:Reference>__ReferenceID2</x:Reference>
          <x:Reference>__ReferenceID3</x:Reference>
          <FlowStep x:Name="__ReferenceID18">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:Point x:Key="ShapeLocation">858.8,30</av:Point>
                <av:Size x:Key="ShapeSize">434,82</av:Size>
                <av:PointCollection x:Key="ConnectorLocation">1292.8,70.5 1215.6,70.5 1215.6,64.8</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign DisplayName="Get - Current Template Name " sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_14">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[CurrentTemplateName]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[Regex.Match(io_TransactionItem("TemplateURL").ToString,"(?&lt;=templates\/)(.*)").ToString]</InArgument>
              </Assign.Value>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </Assign>
            <FlowStep.Next>
              <x:Reference>__ReferenceID4</x:Reference>
            </FlowStep.Next>
          </FlowStep>
          <x:Reference>__ReferenceID5</x:Reference>
          <x:Reference>__ReferenceID6</x:Reference>
          <x:Reference>__ReferenceID7</x:Reference>
          <x:Reference>__ReferenceID8</x:Reference>
          <x:Reference>__ReferenceID9</x:Reference>
          <x:Reference>__ReferenceID10</x:Reference>
          <x:Reference>__ReferenceID11</x:Reference>
          <x:Reference>__ReferenceID0</x:Reference>
          <x:Reference>__ReferenceID12</x:Reference>
          <x:Reference>__ReferenceID13</x:Reference>
          <x:Reference>__ReferenceID14</x:Reference>
          <x:Reference>__ReferenceID15</x:Reference>
          <x:Reference>__ReferenceID16</x:Reference>
          <x:Reference>__ReferenceID17</x:Reference>
          <FlowStep x:Name="__ReferenceID32">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:Point x:Key="ShapeLocation">123,29</av:Point>
                <av:Size x:Key="ShapeSize">434,82</av:Size>
                <av:PointCollection x:Key="ConnectorLocation">557,70 587,70 587,66.1 620,66.1</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign DisplayName="Creative ID" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_23">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[CreativeID]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[io_TransactionItem("CreativeID").ToString]</InArgument>
              </Assign.Value>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </Assign>
            <FlowStep.Next>
              <FlowStep x:Name="__ReferenceID23">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">620,25.6</av:Point>
                    <av:Size x:Key="ShapeSize">200,81</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">820,66.1 850,66.1 850,70.5 858.8,70.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Sequence DisplayName="In Progress API Call " sap:VirtualizedContainerService.HintSize="200,81" sap2010:WorkflowViewState.IdRef="Sequence_87">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_6">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,179" sap2010:WorkflowViewState.IdRef="Sequence_90">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Generate Authentication " sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_27" UnSafe="False" WorkflowFileName="JMSL API\Generate Authentication.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_AuthenticationToken">[JMSL_AuthenticationToken]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_AuthenticationEndpoint">[in_JMSL_APIConfig("AuthenticationEndpoint")]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_UserName">[in_JMSL_APIConfig("AuthenticationUserName")]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Pasword">[in_JMSL_APIConfig("AuthenticationPassword")]</InArgument>
                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_5">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="388,210" sap2010:WorkflowViewState.IdRef="Sequence_89">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Pending API Call " DisplayName="Artwork Creation Pending API Call " sap:VirtualizedContainerService.HintSize="346,118" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_28" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Pending API Call.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InvokeWorkflowFile>
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                </Sequence>
                <FlowStep.Next>
                  <x:Reference>__ReferenceID18</x:Reference>
                </FlowStep.Next>
              </FlowStep>
            </FlowStep.Next>
          </FlowStep>
          <x:Reference>__ReferenceID19</x:Reference>
          <x:Reference>__ReferenceID20</x:Reference>
          <x:Reference>__ReferenceID21</x:Reference>
          <x:Reference>__ReferenceID22</x:Reference>
          <x:Reference>__ReferenceID23</x:Reference>
          <x:Reference>__ReferenceID24</x:Reference>
          <x:Reference>__ReferenceID25</x:Reference>
          <x:Reference>__ReferenceID26</x:Reference>
          <x:Reference>__ReferenceID27</x:Reference>
          <x:Reference>__ReferenceID28</x:Reference>
          <x:Reference>__ReferenceID29</x:Reference>
          <x:Reference>__ReferenceID30</x:Reference>
          <x:Reference>__ReferenceID31</x:Reference>
        </Flowchart>
        <Sequence sap2010:Annotation.AnnotationText="Successful logging for workblock. &#xA;You should also publish the output arguments that you want to make available in the log." DisplayName="wb Logging Successful" sap:VirtualizedContainerService.HintSize="2030,2069" sap2010:WorkflowViewState.IdRef="Sequence_66">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:AddLogFields sap2010:Annotation.AnnotationText="Default wb fields&#xA;wbStatus&#xA;wbState&#xA;wbDurationSec" DisplayName="Publish default wb fields" sap:VirtualizedContainerService.HintSize="436,162" sap2010:WorkflowViewState.IdRef="AddLogFields_29">
            <ui:AddLogFields.Fields>
              <InArgument x:TypeArguments="x:String" x:Key="wbStatus">Successful</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="wbState">Ended</InArgument>
              <InArgument x:TypeArguments="x:Double" x:Key="wbDurationSec">[convert.ToDouble(now.Subtract(wbStartTime).TotalSeconds)]</InArgument>
            </ui:AddLogFields.Fields>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:AddLogFields>
          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="436,328" sap2010:WorkflowViewState.IdRef="CommentOut_8">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,209" sap2010:WorkflowViewState.IdRef="Sequence_95">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:AddLogFields sap2010:Annotation.AnnotationText="Publish output fields" DisplayName="Add log fields" sap:VirtualizedContainerService.HintSize="334,121" sap2010:WorkflowViewState.IdRef="AddLogFields_30">
                  <ui:AddLogFields.Fields>
                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                  </ui:AddLogFields.Fields>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:AddLogFields>
              </Sequence>
            </ui:CommentOut.Body>
          </ui:CommentOut>
          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Generate Authentication " sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_26" UnSafe="False" WorkflowFileName="JMSL API\Generate Authentication.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <OutArgument x:TypeArguments="x:String" x:Key="out_AuthenticationToken">[JMSL_AuthenticationToken]</OutArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_AuthenticationEndpoint">[in_JMSL_APIConfig("AuthenticationEndpoint")]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_UserName">[in_JMSL_APIConfig("AuthenticationUserName")]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_Pasword">[in_JMSL_APIConfig("AuthenticationPassword")]</InArgument>
              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
            </ui:InvokeWorkflowFile.Arguments>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:InvokeWorkflowFile>
          <If Condition="[io_TransactionItem(&quot;ChannelDescription&quot;).ToString.Contains(&quot;Facebook&quot;)]" sap:VirtualizedContainerService.HintSize="436,295" sap2010:WorkflowViewState.IdRef="If_13">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If.Then>
              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Artwork Creation Success API Call " sap:VirtualizedContainerService.HintSize="379,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_11" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Success API Call.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeURL">[io_TransactionItem("CreativeStorePath").ToString +io_TransactionItem("CreativeID").ToString+"/"+io_TransactionItem("CreativeID").ToString+"_1.jpg"]</InArgument>
                  <OutArgument x:TypeArguments="x:Int32" x:Key="out_StatusCode" />
                  <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                  <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                </ui:InvokeWorkflowFile.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeWorkflowFile>
            </If.Then>
            <If.Else>
              <Sequence sap:VirtualizedContainerService.HintSize="533,587" sap2010:WorkflowViewState.IdRef="Sequence_92">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If Condition="[io_TransactionItem(&quot;ChannelDescription&quot;).ToString.Contains(&quot;Viber&quot;)]" sap:VirtualizedContainerService.HintSize="491,497" sap2010:WorkflowViewState.IdRef="If_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <Sequence sap:VirtualizedContainerService.HintSize="409,212" sap2010:WorkflowViewState.IdRef="Sequence_91">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Artwork Creation Success API Call " sap:VirtualizedContainerService.HintSize="367,122" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_25" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Success API Call.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                          <InArgument x:TypeArguments="x:String" x:Key="in_CreativeURL">[Regex.Replace(io_TransactionItem("CreativeStorePath").ToString,"(jmsldamblob)","jmslpubdamblob").ToString +io_TransactionItem("CreativeID").ToString+".jpg"]</InArgument>
                          <OutArgument x:TypeArguments="x:Int32" x:Key="out_StatusCode" />
                          <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                          <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:InvokeWorkflowFile>
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Artwork Creation Success API Call " sap:VirtualizedContainerService.HintSize="367,122" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_47" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Success API Call.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeURL">[io_TransactionItem("CreativeStorePath").ToString +io_TransactionItem("CreativeID").ToString+".jpg"]</InArgument>
                        <OutArgument x:TypeArguments="x:Int32" x:Key="out_StatusCode" />
                        <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                        <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:InvokeWorkflowFile>
                  </If.Else>
                </If>
              </Sequence>
            </If.Else>
          </If>
          <ui:CommentOut DisplayName="Pass Successfull api call " sap:VirtualizedContainerService.HintSize="436,429" sap2010:WorkflowViewState.IdRef="CommentOut_1">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,310" sap2010:WorkflowViewState.IdRef="Sequence_69">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Successful" DisplayName="Set transaction status" ErrorType="Application" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_9" Status="Successful" TransactionItem="[io_TransactionItem]">
                  <ui:SetTransactionStatus.Analytics>
                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                  </ui:SetTransactionStatus.Analytics>
                  <ui:SetTransactionStatus.Output>
                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                  </ui:SetTransactionStatus.Output>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:SetTransactionStatus>
              </Sequence>
            </ui:CommentOut.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:CommentOut>
          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute Non Query: Update Retry status" ExistingDbConnection="[in_DatabaseConnection]" sap:VirtualizedContainerService.HintSize="436,89" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_1" Sql="[&quot;update &quot;+in_QA_ProdSwitch+&quot;.[bot].[GenerationFailedCreatives] Set Status='Success' Where CreativeID = '&quot;+CreativeID+&quot;'&quot;]">
            <ui:ExecuteNonQuery.Parameters>
              <scg:Dictionary x:TypeArguments="x:String, Argument" />
            </ui:ExecuteNonQuery.Parameters>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:ExecuteNonQuery>
          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Write log" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_32" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">[wbPath.Count(Function(x) x="|").ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">[wbPath]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Successful</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[convert.ToDouble(now.Subtract(wbStartTime).TotalSeconds).ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbKey" />
              <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[io_TransactionItem("CreativeID").ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Ended</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbName">[wbName]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">[if(wbPath.Count(Function(x) x="|") = 0, string.Empty, wbPath.Split("|".ToCharArray)(wbPath.Count(Function(x) x="|")-1))]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[wbStartTime.ToString]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_Message">[wbPath + " execution ended with success."]</InArgument>
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
          <ui:LogMessage DisplayName="Log execution ended message" sap:VirtualizedContainerService.HintSize="436,92" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[wbPath + &quot; execution ended with success.&quot;]" />
        </Sequence>
      </Sequence>
    </TryCatch.Try>
    <TryCatch.Catches>
      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="2076,2760" sap2010:WorkflowViewState.IdRef="Catch`1_7">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ActivityAction x:TypeArguments="s:Exception">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Catch, log and rethrow" sap:VirtualizedContainerService.HintSize="1264,2691" sap2010:WorkflowViewState.IdRef="Sequence_68">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Sequence sap2010:Annotation.AnnotationText="Failed logging for workblock. &#xA;You should only set transaction status if you use a QueueItem, otherwise failed logging should remain unchanged." DisplayName="wb Logging Failed" sap:VirtualizedContainerService.HintSize="1222,2541" sap2010:WorkflowViewState.IdRef="Sequence_67">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="Dt_retry" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:AddLogFields sap2010:Annotation.AnnotationText="Default wb fields&#xA;wbStatus&#xA;wbState&#xA;wbDurationSec&#xA;wbExceptionType&#xA;wbExceptionMessage" DisplayName="Publish default wb fields" sap:VirtualizedContainerService.HintSize="512,192" sap2010:WorkflowViewState.IdRef="AddLogFields_31">
                <ui:AddLogFields.Fields>
                  <InArgument x:TypeArguments="x:String" x:Key="wbStatus">Failed</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="wbState">Ended</InArgument>
                  <InArgument x:TypeArguments="x:Double" x:Key="wbDurationSec">[convert.ToDouble(now.Subtract(wbStartTime).TotalSeconds)]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="wbExceptionType">[exception.GetType.Name]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="wbExceptionMessage">[exception.Message]</InArgument>
                </ui:AddLogFields.Fields>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:AddLogFields>
              <If Condition="[if (exception isNot Nothing ANDALSO exception.GetType.Name = &quot;BusinessRuleException&quot;, true, false)]" DisplayName="If AppEx Or BRE" sap:VirtualizedContainerService.HintSize="512,1118" sap2010:WorkflowViewState.IdRef="If_10">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence DisplayName="Business Level Exception" sap:VirtualizedContainerService.HintSize="478,936" sap2010:WorkflowViewState.IdRef="Sequence_77">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:CommentOut DisplayName="Send Business error API call " sap:VirtualizedContainerService.HintSize="436,389" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                      <ui:CommentOut.Body>
                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,310" sap2010:WorkflowViewState.IdRef="Sequence_70">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Business Rule exception" DisplayName="Set transaction status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_14" Reason="[exception.Message]" Status="Failed" TransactionItem="[io_TransactionItem]">
                            <ui:SetTransactionStatus.Analytics>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Analytics>
                            <ui:SetTransactionStatus.Output>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Output>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:SetTransactionStatus>
                        </Sequence>
                      </ui:CommentOut.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:CommentOut>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Generate Authentication " sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_29" UnSafe="False" WorkflowFileName="JMSL API\Generate Authentication.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <OutArgument x:TypeArguments="x:String" x:Key="out_AuthenticationToken">[JMSL_AuthenticationToken]</OutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_AuthenticationEndpoint">[in_JMSL_APIConfig("AuthenticationEndpoint")]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_UserName">[in_JMSL_APIConfig("AuthenticationUserName")]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Pasword">[in_JMSL_APIConfig("AuthenticationPassword")]</InArgument>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Writelog workflow" sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_46" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">0</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">ProcessLayer | ProcessTransaction</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Failed</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(Now.Subtract(wbStartTime).TotalSeconds).ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                          <Literal x:TypeArguments="x:String" Value="" />
                        </InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Error</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbName">Artwork Creation Failed API Call</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">JMSL API</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[wbStartTime.ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">[wbPath + " execution ended with exception message: "+exception.Message]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Artwork Creation Failed API Call " sap:VirtualizedContainerService.HintSize="436,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_14" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Failed API Call.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="In_ProcessFaliureMessage">["Business Level Exception Occur: " + exception.Message]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                        <OutArgument x:TypeArguments="x:Int32" x:Key="out_StatusCode" />
                        <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                        <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnetion">[in_DatabaseConnection]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:InvokeWorkflowFile>
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Sequence DisplayName="Application  Level Exception" sap:VirtualizedContainerService.HintSize="759,592" sap2010:WorkflowViewState.IdRef="Sequence_76">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:CommentOut DisplayName="Send Application Error api call " sap:VirtualizedContainerService.HintSize="717,51" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                      <ui:CommentOut.Body>
                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="241.6,146.4" sap2010:WorkflowViewState.IdRef="Sequence_71">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="System exception" DisplayName="Set transaction status" ErrorType="Application" sap:VirtualizedContainerService.HintSize="200,53.6" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_15" Reason="[exception.Message]" Status="Failed" TransactionItem="[io_TransactionItem]">
                            <ui:SetTransactionStatus.Analytics>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Analytics>
                            <ui:SetTransactionStatus.Output>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Output>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:SetTransactionStatus>
                        </Sequence>
                      </ui:CommentOut.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:CommentOut>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Generate Authentication " sap:VirtualizedContainerService.HintSize="717,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_30" UnSafe="False" WorkflowFileName="JMSL API\Generate Authentication.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <OutArgument x:TypeArguments="x:String" x:Key="out_AuthenticationToken">[JMSL_AuthenticationToken]</OutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_AuthenticationEndpoint">[in_JMSL_APIConfig("AuthenticationEndpoint")]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_UserName">[in_JMSL_APIConfig("AuthenticationUserName")]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Pasword">[in_JMSL_APIConfig("AuthenticationPassword")]</InArgument>
                        <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <If Condition="[in_RetryNumber = Cint(in_Config(&quot;MaxRetryNumber&quot;).ToString)]" DisplayName="If - Send Failed When all the Retries failed" sap:VirtualizedContainerService.HintSize="717,318" sap2010:WorkflowViewState.IdRef="If_12">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Artwork Creation Failed API Call " sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_19" UnSafe="False" WorkflowFileName="JMSL API\Artwork Creation Failed API Call.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="In_ProcessFaliureMessage">["Application Level Exception Occur : " + exception.Message + "Maximum Retry exceed : Retry count - "+in_RetryNumber.ToString]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                            <OutArgument x:TypeArguments="x:Int32" x:Key="out_StatusCode" />
                            <InArgument x:TypeArguments="x:String" x:Key="in_JMSL_AuthenticationToken">[JMSL_AuthenticationToken]</InArgument>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_JMSL_APIConfig">[in_JMSL_APIConfig]</InArgument>
                            <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnetion">[in_DatabaseConnection]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InvokeWorkflowFile>
                      </If.Then>
                      <If.Else>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[io_ExceptionRetryData(0)]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">True</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[io_ExceptionRetryData(0)]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[io_PreviousTemplateName]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[io_ExceptionRetryData(2)]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[io_TemplateFullFilePath]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:MultipleAssign>
                      </If.Else>
                    </If>
                  </Sequence>
                </If.Else>
              </If>
              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="&quot;select * from &quot;+in_QA_ProdSwitch+&quot;.[bot].[GenerationFailedCreatives] where CreativeID = '&quot;+CreativeID+&quot;'&quot;" DisplayName="Query - Select failed record" sap:VirtualizedContainerService.HintSize="512,170" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_48" UnSafe="False" WorkflowFileName="Common\SelectRecordsFromDB.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DBConnection">[in_DatabaseConnection]</InArgument>
                  <InArgument x:TypeArguments="x:Int32" x:Key="in_RetryCount">2</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_ResultDatatable">[Dt_retry]</OutArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_SelectQuery">["select * from "+in_QA_ProdSwitch+".[bot].[GenerationFailedCreatives] where CreativeID = '"+CreativeID+"'"]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_ConnectionString" />
                  <InArgument x:TypeArguments="x:String" x:Key="in_ProviderName" />
                  <InArgument x:TypeArguments="x:Int32" x:Key="in_initialDelay">3000</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_WbPath">Main | ProcessTransaction</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">
                    <Literal x:TypeArguments="x:String" Value="" />
                  </InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_WbParentName">Main</InArgument>
                  <InArgument x:TypeArguments="s:DateTime" x:Key="in_WbStartTime">[Now]</InArgument>
                  <InArgument x:TypeArguments="x:Int32" x:Key="in_ActivityTimeOut">30000</InArgument>
                </ui:InvokeWorkflowFile.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeWorkflowFile>
              <If Condition="[Dt_retry.Rows.Count&gt;0]" sap:VirtualizedContainerService.HintSize="512,488" sap2010:WorkflowViewState.IdRef="If_15">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence sap:VirtualizedContainerService.HintSize="376,306" sap2010:WorkflowViewState.IdRef="Sequence_93">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute Non Query: update flag" ExistingDbConnection="[in_DatabaseConnection]" sap:VirtualizedContainerService.HintSize="334,89" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_2" Sql="[&quot;update &quot;+in_QA_ProdSwitch+&quot;.[bot].[GenerationFailedCreatives] set RetryStatus = 'false' where creativeID = '&quot;+CreativeID+&quot;'&quot;]">
                      <ui:ExecuteNonQuery.Parameters>
                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                      </ui:ExecuteNonQuery.Parameters>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ExecuteNonQuery>
                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute Non Query: Update retry count" ExistingDbConnection="[in_DatabaseConnection]" sap:VirtualizedContainerService.HintSize="334,89" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_3" Sql="[&quot;update &quot;+in_QA_ProdSwitch+&quot;.[bot].[GenerationFailedCreatives] Set Reason = '&quot;+exception.Message.Replace(&quot;'&quot;,&quot;&quot;)+&quot;', ErrorDate ='&quot;+Now.ToString+&quot;', RetryCount=(select RetryCount from &quot;+in_QA_ProdSwitch+&quot;.[bot].[DistributionFailedCreatives] where CreativeID='&quot;+CreativeID+&quot;')+1 Where CreativeID = '&quot;+CreativeID+&quot;'&quot;]">
                      <ui:ExecuteNonQuery.Parameters>
                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                      </ui:ExecuteNonQuery.Parameters>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ExecuteNonQuery>
                  </Sequence>
                </If.Then>
                <If.Else>
                  <ui:ExecuteQuery ContinueOnError="{x:Null}" DataTable="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute  : Add to error table" ExistingDbConnection="[in_DatabaseConnection]" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_1" Sql="[&quot;INSERT INTO &quot;+in_QA_ProdSwitch+&quot;.[bot].[GenerationFailedCreatives] ([CreativeID],[Status],[Reason],[ErrorDate],[RetryCount]) VALUES ('&quot;+CreativeID+&quot;','Failed','&quot;+exception.Message+&quot;','&quot;+Now.ToString+&quot;',1)&quot;]">
                    <ui:ExecuteQuery.Parameters>
                      <scg:Dictionary x:TypeArguments="x:String, Argument" />
                    </ui:ExecuteQuery.Parameters>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExecuteQuery>
                </If.Else>
              </If>
              <ui:LogMessage DisplayName="Log execution ended message" sap:VirtualizedContainerService.HintSize="512,92" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Error" Message="[wbPath + &quot; execution ended with exception message: &quot;+exception.Message]" />
              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Writelog workflow" sap:VirtualizedContainerService.HintSize="512,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_45" UnSafe="False" WorkflowFileName="Logs\Writelog.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="ui:DatabaseConnection" x:Key="in_DatabaseConnection">[in_DatabaseConnection]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbLevel">0</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbPath">ProcessLayer | ProcessTransaction</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbStatus">Failed</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbDurationSec">[Convert.ToDouble(Now.Subtract(wbStartTime).TotalSeconds).ToString]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbKey">
                    <Literal x:TypeArguments="x:String" Value="" />
                  </InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_CreativeID">[CreativeID]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbState">Error</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbName">Artwork Creation Failed API Call</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbParentName">JMSL API</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_wbStartTime">[wbStartTime.ToString]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_Message">[wbPath + " execution ended with exception message: "+exception.Message]</InArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
            </Sequence>
            <Rethrow sap:VirtualizedContainerService.HintSize="1222,22" sap2010:WorkflowViewState.IdRef="Rethrow_13" />
          </Sequence>
        </ActivityAction>
      </Catch>
    </TryCatch.Catches>
  </TryCatch>
</Activity>